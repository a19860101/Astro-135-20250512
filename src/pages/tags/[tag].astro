---
import BaseLayout from "../../layouts/BaseLayout.astro";
export function getStaticPaths(){
    const allPosts = Object.values(import.meta.glob('../blog/posts/*.md',{eager: true}))
    // const uniqueTags = [...new Set(allPosts.map((post:any) => post.frontmatter.tags).flat())]
    const uniqueTags = Array.from(new Set(allPosts.map((post:any) => post.frontmatter.tags).flat()))
    // return [
    //     {params: {tag: 'astro'},props:{posts: allPosts}},
    //     {params: {tag: '輝達'},props:{posts: allPosts}}
    // ]


    return uniqueTags.map((tag:any) =>{
        const filterPosts = allPosts.filter((post:any) => post.frontmatter.tags.includes(tag))
        return {
            params: {tag},
            props: {posts: filterPosts}
        }
    })
}

const {tag} = Astro.params
const {posts} = Astro.props
---
<BaseLayout pageTitle={tag}>
    {tag} 

    {
        posts.map((post:any) => <div>{post.frontmatter.title}</div>)
    }
</BaseLayout>